<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><title>linux 常用命令 | World of Wang</title><meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1"><link rel="canonical" href="https://wzhongke.github.io/post/linux/linux-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/ocean.min.css" rel="stylesheet"><link rel="stylesheet" href="https://wzhongke.github.io//css/index-36d28184b1.css"><link href="https://wzhongke.github.io/index.xml" rel="alternate" type="application/rss+xml" title="World of Wang"><link href="https://wzhongke.github.io/index.xml" rel="feed" type="application/rss+xml" title="World of Wang"><link href="https://wzhongke.github.io//favicon.ico" rel="shortcut icon"><script>window.origin = "https://wzhongke.github.io/";
    
    var outer = document.createElement('div');
    outer.style.cssText = "visibility:hidden;width:100%;overflow:scroll";
    document.documentElement.appendChild(outer);
    window.scrollWidth = outer.offsetWidth - outer.clientWidth;
    document.documentElement.removeChild(outer);</script></head><body><div id="modal-search" class="modal"><div class="modal-content"><form><div class="row"><div class="input-field col s12"><input id="in-search" type="text" required aria-required="true" autofocus autocomplete="off"> <label for="in-search">Search</label></div></div></form><div class="out-wrapper row"><div id="out-search" class="collection col s12"></div></div></div></div><div class="navbar-fixed"><nav class="navbar"><div class="nav-wrapper container"><a href="javascript:void(0)" class="button-collapse"><i class="material-icons">menu</i></a> <a href="https://wzhongke.github.io/" class="brand-logo"><i class="material-icons">restaurant_menu</i> World of Wang</a><ul class="right hide-on-small-and-down"><li><a class="modal-trigger" href="#modal-search"><i class="material-icons">search</i></a></li><li><a href="https://wzhongke.github.io/index.xml" target="_blank"><i class="material-icons">rss_feed</i></a></li></ul><ul class="center tabs tabs-transparent hide-on-med-and-down"><li class="tab"><a href="https://wzhongke.github.io//" class="">Home</a></li><li class="tab"><a href="https://wzhongke.github.io//archive/" class="">Archive</a></li><li class="tab"><a href="https://wzhongke.github.io//about/" class="">About</a></li><li class="tab"><a href="https://wzhongke.github.io//post/%E7%A2%B0%E5%88%B0%E8%BF%87%E7%9A%84%E9%97%AE%E9%A2%98/" class="">碰到过的问题</a></li></ul></div></nav></div><aside class="side-panel"><div class="inner"><div class="profile"><div class="profile__bg" style="background-image:url('https://wzhongke.github.io//img/profile-bg-7c6e6a1672.jpg')"></div><img class="profile__avatar" src="https://wzhongke.github.io//img/sign-d1f802b4e8.jpg" alt="avatar"><h3 class="profile__name">壹冶知秋</h3><p class="profile__desc">Do not ride on fear...</p></div><ul class="nav-group show-on-medium-and-down menu"><li><a class="collapsible-header waves-effect waves-indigo" href="https://wzhongke.github.io//"><i class="material-icons">home</i> <span class="content">Home</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="https://wzhongke.github.io//archive/"><i class="material-icons">archive</i> <span class="content">Archive</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="https://wzhongke.github.io//about/"><i class="material-icons">person</i> <span class="content">About</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="https://wzhongke.github.io//post/%E7%A2%B0%E5%88%B0%E8%BF%87%E7%9A%84%E9%97%AE%E9%A2%98/"><i class="material-icons">bookmark</i> <span class="content">碰到过的问题</span> <i class="material-icons">chevron_right</i></a></li></ul><ul class="nav-group show-on-small tools"><li><a class="collapsible-header waves-effect waves-indigo modal-trigger" href="#modal-search"><i class="material-icons">search</i> <span class="content">Search</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" target="_blank" href="https://wzhongke.github.io/index.xml"><i class="material-icons">rss_feed</i> <span class="content">RSS Feed</span> <i class="material-icons">chevron_right</i></a></li></ul><ul class="collapsible nav-group" data-collapsible="accordion"><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons">whatshot</i> <span class="content">Latest</span> <i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="https://wzhongke.github.io/post/">Posts</a> <a class="collection-item" href="https://wzhongke.github.io/post/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E4%BA%BA%E7%94%9F%E7%9A%84%E6%99%BA%E6%85%A7-%E5%8F%94%E6%9C%AC%E5%8D%8E/">人生的智慧_叔本华</a> <a class="collection-item" href="https://wzhongke.github.io/post/node/node%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/">node使用笔记</a> <a class="collection-item" href="https://wzhongke.github.io/post/node/typeorm/">typeorm</a> <a class="collection-item" href="https://wzhongke.github.io/post/java/spring-%E6%BA%90%E7%A0%81/">深入浅出 nodejs</a> <a class="collection-item" href="https://wzhongke.github.io/post/java/java%E5%A0%86%E5%86%85%E5%AD%98/">java 内存以及GC</a> <a class="collection-item" href="https://wzhongke.github.io/post/java/java%E8%AE%A1%E7%AE%97%E5%86%85%E5%AD%98/">java 使用代码计算内存</a> <a class="collection-item" href="https://wzhongke.github.io/post/node/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAnode/">深入浅出 nodejs</a> <a class="collection-item" href="https://wzhongke.github.io/post/front/javascript/">javascript 基础</a> <a class="collection-item" href="https://wzhongke.github.io/post/java/netty/">高并发 netty</a></div></div></li><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons"><i class="material-icons">class</i></i> <span class="content">Category </span><i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="https://wzhongke.github.io//categories/java">java<span class="badge">13</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/linux">linux<span class="badge">9</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/javascript">javascript<span class="badge">7</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/%E7%AE%97%E6%B3%95">算法<span class="badge">7</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/python">python<span class="badge">5</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">设计模式<span class="badge">5</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/other">other<span class="badge">4</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/mysql">mysql<span class="badge">3</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/%E5%B7%A5%E5%85%B7">工具<span class="badge">3</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/css">css<span class="badge">2</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0">读书笔记<span class="badge">2</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/error">error<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/markdown">markdown<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/nodejs">nodejs<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/sql">sql<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/svg">svg<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/vue">vue<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/%E6%97%85%E8%A1%8C">旅行<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//categories/%E7%BC%96%E7%A8%8B">编程<span class="badge">1</span></a></div></div></li><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons"><i class="material-icons">local_offer</i></i> <span class="content">Tag </span><i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="https://wzhongke.github.io//tags/java">java<span class="badge">13</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/linux">linux<span class="badge">9</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/javascript">javascript<span class="badge">6</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/%E7%AE%97%E6%B3%95">算法<span class="badge">6</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/python">python<span class="badge">5</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">设计模式<span class="badge">5</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/other">other<span class="badge">4</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/mysql">mysql<span class="badge">3</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/%E5%B7%A5%E5%85%B7">工具<span class="badge">3</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/css">css<span class="badge">2</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/markdown">markdown<span class="badge">2</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/error">error<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/nodejs">nodejs<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/sql">sql<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/svg">svg<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/%E6%97%85%E8%A1%8C">旅行<span class="badge">1</span></a> <a class="collection-item" href="https://wzhongke.github.io//tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0">读书笔记<span class="badge">1</span></a></div></div></li></ul><ul class="nav-group external-link"><li><a class="collapsible-header waves-effect waves-indigo" href="https://github.com/wzhongke" target="_blank"><svg class="svg-icons svg-icons-github"><use xlink:href="#svg-icons-github"></use></svg> <span class="content">Github<small>@wzhongke</small></span> <i class="material-icons">chevron_right</i></a></li></ul></div></aside><main id="single" role="main" class="main-panel"><section class="container"><div class="inner"><div class="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation"><a class="breadcrumb" href="https://wzhongke.github.io/"><i class="material-icons">location_on</i>Home</a> <a class="breadcrumb" href="https://wzhongke.github.io/post/">Post</a> <a class="breadcrumb" href="https://wzhongke.github.io/post/linux/">Linux</a> <span class="breadcrumb">linux 常用命令</span></div><section class="post-wrapper"><div class="toc-panel"><nav id="TableOfContents"><ul><li><a href="#rsync命令"><code>rsync</code>命令</a></li></ul><ul><li><a href="#ps--将某个时间点的进程运行情况选取下来"><code>ps</code> : 将某个时间点的进程运行情况选取下来</a></li><li><a href="#top-动态查看进程的变化">top 动态查看进程的变化</a></li><li><a href="#pstree-查看进程树">pstree 查看进程树</a></li><li><a href="#kill-进程管理">kill 进程管理</a></li></ul><ul><li><a href="#sed"><code>sed</code></a></li><li><a href="#grep-命令"><code>grep</code> 命令</a></li><li><a href="#awk-命令"><code>awk</code> 命令</a><ul><li><a href="#awk-条件判断"><code>awk</code> 条件判断</a></li><li><a href="#awk-正则匹配"><code>awk</code> 正则匹配</a></li><li><a href="#awk-内建函数"><code>awk</code> 内建函数</a></li></ul></li></ul></nav></div><div class="post"><div class="card"><div class="card-content"><span class="card-title">linux 常用命令 </span><span class="card-meta"><time><span>Sat Jun 17 2017</span></time><address><a href="https://wzhongke.github.io//categories/linux">linux</a>&nbsp;</address></span><article class="article"><p>使用ubuntu的时候经常会把常用的一些命令忘掉或不知道有些参数的意思，又懒得看那枯燥的文档。因此记录下来备忘。<!-- raw HTML omitted --></p><!-- raw HTML omitted --><h1 id="目录类">目录类</h1><ol><li><p>ls: 查看文件与目录</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ls <span style="color:#f92672">[</span>-aAdfFhilnrRSt<span style="color:#f92672">]</span> 目录或文件
ls <span style="color:#f92672">[</span>--color<span style="color:#f92672">={</span>never,auto,always<span style="color:#f92672">}]</span> 目录或文件
ls <span style="color:#f92672">[</span>--full-time<span style="color:#f92672">]</span> 目录或文件
-a: 列出全部文件，包括隐藏文件
-A: 列出全部文件，包括隐藏文件，但不包括 . 与 .. 两个目录
-d: 仅列出目录，不列出目录内的文件
-f: 直接列出结果，不进行排序 <span style="color:#f92672">(</span>ls默认会以文件名排序<span style="color:#f92672">)</span>
-F: 根据文件、目录等信息给予附件数据结构 <span style="color:#f92672">(</span> *:代表可执行文件，/: 代表目录，<span style="color:#f92672">=</span>: 代表socket文件，|: 代表FIFO文件<span style="color:#f92672">)</span>
-h: 将文件容量以易读的方式列出
-i: 列出inode号码
-l: 列出文件属性权限等
-n: 列出UID与GID，而非用户与用户组名
-r: 将排序结果反向输出
-R: 连同子目录内容一起列出来
-S: 以文件容量大小排序
-t: 以时间排序
-color: never<span style="color:#f92672">(</span>不要依据文件特性给予颜色显示<span style="color:#f92672">)</span>，always<span style="color:#f92672">(</span>显示颜色<span style="color:#f92672">)</span>，auto<span style="color:#f92672">(</span>系统判定是否显示颜色<span style="color:#f92672">)</span>
--full-time: 以完整的时间模式输出 年、月、日、时、分
--time<span style="color:#f92672">={</span>atime, ctime<span style="color:#f92672">}</span>: 输出访问时间或改变权限属性时间<span style="color:#f92672">(</span>ctime<span style="color:#f92672">)</span>，而非内容更改时间
</code></pre></div></li><li><p>cd: 切换目录</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cd <span style="color:#f92672">[</span>相对路径或者绝对路径<span style="color:#f92672">]</span>
<span style="color:#75715e">#回到自己的主文件夹</span>
cd <span style="color:#f92672">[</span>or cd ~<span style="color:#f92672">]</span>
<span style="color:#75715e">#回到上层目录</span>
cd ..
<span style="color:#75715e">#回到刚才的目录</span>
cd -
</code></pre></div></li><li><p>pwd : 显示当前目录</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pwd <span style="color:#f92672">[</span>-P<span style="color:#f92672">]</span>
-P:显示当前的路径，而非使用连接路径
</code></pre></div></li><li><p>mkdir : 新建目录</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir <span style="color:#f92672">[</span>-mp<span style="color:#f92672">]</span> 目录名称
-m:配置文件夹的权限，忽略默认权限（umask<span style="color:#f92672">)</span>
-p:递归地创建目录
<span style="color:#75715e">#新建权限为rwx--x--x的目录</span>
mkdir -m <span style="color:#ae81ff">711</span> dir_name
</code></pre></div></li></ol><h1 id="复制删除移动">复制删除移动</h1><ol><li><p>复制 cp</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#只复制一个文件或文件夹</span>
cp <span style="color:#f92672">[</span>-adfilprsu<span style="color:#f92672">]</span> 源文件 目标文件
-a: 相当于 -pdr，看后文
-d：若文件为连接文件，则只复制连接文件的属性
-f: 若目标文件已经存在且无法开启，则删除后再试一次
-i: 若目标文件已存在，覆盖时会先询问是否覆盖
-l: 创建文件的硬链接
-p: 连同文件的属性一起复制，备份常用
**-r: 递归复制，用于目录的复制**
-s: 创建文件的软连接
-u: 若目标文件比源文件旧才更新目标文件
<span style="color:#75715e">#复制多个文件到某一文件夹下</span>
$ cp <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> 源文件1 源文件2 ... 目标文件
</code></pre></div></li><li><p>移除文件或目录</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rm <span style="color:#f92672">[</span>-fir<span style="color:#f92672">]</span> 文件或目录
-f: 忽略不存在的文件
-i: 删除前再次确认
-r: 递归删除，主要用来删除目录
</code></pre></div></li><li><p>移动文件目录或者更名</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mv <span style="color:#f92672">[</span>-fiu<span style="color:#f92672">]</span> 文件或目录 目标文件或目录
-f: 目标文件存在时，不询问直接覆盖
-i: 目标文件存在，询问是否覆盖
-u: 目标文件存在，且较新时，才会更新
</code></pre></div></li><li><p>非纯文本 <code>od</code></p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">od <span style="color:#f92672">[</span>-t TYPE<span style="color:#f92672">]</span> 文件
-t: 后面可以接各种类型输出：
a : 利用默认字符输出
c : 使用ASCII字符输出
d<span style="color:#f92672">[</span>size<span style="color:#f92672">]</span>: 用十进制输出数据，每个整数占用 size bytes
f<span style="color:#f92672">[</span>siez<span style="color:#f92672">]</span>: 用浮点数输出数据，每个整数占用 size bytes
o<span style="color:#f92672">[</span>size<span style="color:#f92672">]</span>: 用八进制来输出数据，每个整数占用 size bytes
x<span style="color:#f92672">[</span>size<span style="color:#f92672">]</span>: 用十六进制来输出数据，每个整数占用 size bytes
</code></pre></div></li><li><p>连接文件 <code>ln</code> 硬连接是将文件对应到同一个inode号码上的连接。硬连接不能跨文件系统，不能连接到目录。符号连接就是windows下的快捷方式。</p></li></ol><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ln <span style="color:#f92672">[</span>-sf<span style="color:#f92672">]</span> 源文件 目标文件<span style="color:#f92672">(</span>符合连接文件<span style="color:#f92672">)</span>
    -s: 创建符号连接，而不是硬连接
    -f: 如果目标文件存在，就将目标文件删除后再创建
</code></pre></div><ol start="6"><li>清空文件 清空文件有三种方式：</li></ol><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /dev/null &gt; clear.txt
echo <span style="color:#e6db74">&#34;&#34;</span> &gt; clear.txt
&gt; clear.txt
</code></pre></div><h1 id="命令与文件查询">命令与文件查询</h1><ol><li><p>which：可以查询脚本文件的位置，比如 <code>ifconfig</code> 命令的位置。但是不能够查询bash内置的命令，比如<code>cd</code></p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">which <span style="color:#f92672">[</span>-a<span style="color:#f92672">]</span> command
-a: 列出所有 PATH 目录中包含的命令，没有该参数，只会列出第一个
</code></pre></div></li><li><p>whereis： 定位命令的二进制，源文件和帮助文件</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">whereis <span style="color:#f92672">[</span>-bmsu<span style="color:#f92672">]</span> 文件或目录名
-b : 只找二进制文件
-m : 在menu下查找
-s : 只找源文件
-u : 其他文件
</code></pre></div></li><li><p>locate： 根据文件名搜索文件，输出所有的文件。因为是从存储文件记录的数据库文件<code>/var/lib/mlocate</code>中读取的，所以速度快。但是数据库文件是定时更新的，所以新增的文件查询不到。可以通过<code>updatedb</code>来更新文件，因为该命令是查找硬盘的，所以执行比较慢。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">locate <span style="color:#f92672">[</span>-ir<span style="color:#f92672">]</span> 文件名
-i: 忽略大小写差异
-r: 可以接正则表达式
</code></pre></div></li><li><p>find: 在目录下搜索文件，与xargs一起使用，功能强大</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find <span style="color:#f92672">[</span>PATH<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>option<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>action<span style="color:#f92672">]</span>
<span style="color:#75715e"># 与时间有关的参数有 -atime, -ctime, -mtime, 这三个参数使用方法类似。</span>
-mtime n: 在n天之前的 一天内 被更改过的文件
-mtime +n: 在n天之前（不含n天）被更改过的文件
-mtime -n: 在n天之内（含n天） 被更改过的文件
-newer file: file问一个文件的路径，列出比file新的文件
-newermt time: 比time更新的文件

-type TYPE: 查找的文件类型，主要有： 一般文件<span style="color:#f92672">(</span>f<span style="color:#f92672">)</span>, 设备文件<span style="color:#f92672">(</span>b,c<span style="color:#f92672">)</span>, 目录<span style="color:#f92672">(</span>d<span style="color:#f92672">)</span>, 连接文件<span style="color:#f92672">(</span>l<span style="color:#f92672">)</span>, socket<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>等
-perm <span style="color:#f92672">[</span>+/-<span style="color:#f92672">]</span>mode: 查找文件权限，刚好等于mode， <span style="color:#e6db74">&#34;-&#34;</span> 表示文件权限必须包含 mode， <span style="color:#e6db74">&#34;+&#34;</span> 表示文件权限包含任一 mode

-name filename: 查找文件名为filename的文件， 使用通配符表示文件名时，需要加上 <span style="color:#e6db74">&#39;&#39;</span>
-size <span style="color:#f92672">[</span>+-<span style="color:#f92672">]</span>SIZE: 查找比size还要大<span style="color:#f92672">(</span>+<span style="color:#f92672">)</span>或小<span style="color:#f92672">(</span>-<span style="color:#f92672">)</span>的文件 ,可以是用K<span style="color:#ae81ff">\M\G</span>

-exec command: command为命令，该命令可以处理查找结果，不支持别名。
find / -exec ls -l <span style="color:#f92672">{}</span><span style="color:#ae81ff">\;</span>
find命令会将所有匹配到的文件一起传递给exec执行，但有些系统对能够传递给exec的命令有长度限制，会出现溢出错误。这时候可以使用xargs。
find . | xargs grep xxx: 查找当前目录下含有x的文件
</code></pre></div></li><li><p>xargs: 给其他命令传递参数的一个过滤器，可以将标准输出数据转换成命令行参数</p></li></ol><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; cat test.txt
a b c d e f g
h i j k l m n
o p q
&gt; cat test.txt | xargs
a b c d e f g h i j k l m n o p q
&gt; cat test.txt | xargs -n3
a b c
d e f
g h i
j k l
m n o
p q 

&gt; cat arg.txt | xargs -I <span style="color:#f92672">{}</span> ./sk.sh -p <span style="color:#f92672">{}</span> -l
-p aaa -l
-p bbb -l
-p ccc -l
</code></pre></div><h1 id="更改权限">更改权限</h1><p>权限分数为： r(read)=4, w(write)=2, x(execute)=1 <code>bash chgrp [-R（递归更改)] groupname dirname/filename: 改变文件所属用户组 chown [-R（递归更改)] username[:groupname] dirname/filename：改变文件所有者 chmod [-R（递归更改)] [options] dirname/filename：改变文件所有者 chmod 761 file: 将文件权限更改为 =rwxrw---x chmod u=rwx,g=rw,o=x file: u(user) g(group) o(others) =(设置) +(增加) -(取消)</code></p><h1 id="数据流重定向">数据流重定向</h1><ul><li><code>1&gt;</code> : 以覆盖的方式将正确的数据输出到指定的文件或设备上</li><li><code>1&gt;&gt;</code> : 以累加的方式将正确的数据输出到指定的文件或设备上</li><li><code>2&gt;</code> : 以覆盖的方式将错误的数据输出到指定的文件或设备上</li><li><code>2&gt;&gt;</code> : 以累加的方式将错误的数据输出到指定的文件或设备上</li><li><code>command &gt; list 2&gt;&amp;1</code> ： 将正确信息和错误信息都输入到list文件中</li><li><code>command 2&gt; /dev/null</code> : 不保存错误信息</li></ul><h1 id="命令执行判断依据---">命令执行判断依据： <code>;</code> <code>&amp;&amp;</code> <code>||</code></h1><ul><li><code>com1;com2</code> 不考虑命令的相关性，连续执行命令</li><li><code>com1&amp;&amp;com2</code> 前一个命令执行正确($?=0)，才执行第二个命令</li><li><code>com1||com2</code> 前一个命令执行不正确($?!=0)，才执行第二个命令</li></ul><h1 id="查看文件内容">查看文件内容</h1><ol><li><p>cat</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat <span style="color:#f92672">[</span>-AbEnTv<span style="color:#f92672">]</span> 文件
-A: 相当于-vET 的整合，可列出一些特殊字符而不是空白
-b: 列出行号，仅针对非空白行做行号显示
-E: 将结尾的断行字符以 $ 显示出来
-n: 打印行号，连同空白行也会有行号
-T: 将<span style="color:#f92672">[</span>Tab<span style="color:#f92672">]</span>以 ^I显示出来
-v: 列出一些看不出来的特殊字符
</code></pre></div></li><li><p>翻页查看more</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">more 文件路径
<span style="color:#75715e">#空格键    向下翻一页</span>
<span style="color:#75715e">#Enter    向下滚动一行</span>
<span style="color:#75715e">#/字符串   在内容中向下查找字符串</span>
<span style="color:#75715e">#:f       显示文件名以及目前显示的行数</span>
<span style="color:#75715e">#q        离开more，不再显示内容</span>
<span style="color:#75715e">#b        向回翻页，只对文件有效</span>
</code></pre></div></li><li><p>翻页查看 less</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">less 文件路径
<span style="color:#75715e">#空格键         向下翻一页</span>
<span style="color:#75715e">#[PageDown]    向下翻一页</span>
<span style="color:#75715e">#[PageUp]      向上翻一页</span>
<span style="color:#75715e">#/字符串   在内容中向下查找字符串</span>
<span style="color:#75715e">#?字符串   在内容中向上查找字符串</span>
<span style="color:#75715e">#n        重复前一个查询</span>
<span style="color:#75715e">#N        向上重复前一个查询</span>
<span style="color:#75715e">#q        离开</span>
</code></pre></div></li><li><p>数据选取 head</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">head <span style="color:#f92672">[</span>-n number<span style="color:#f92672">]</span> 文件
-n: 接数字，表示显示头几行，默认显示前10行
</code></pre></div></li><li><p>数据选取tail</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tail <span style="color:#f92672">[</span>-n number<span style="color:#f92672">]</span> 文件
-n: 表示显示几行
</code></pre></div></li></ol><p>另外可以修改 /etc/issue文件来改变终端的提示信息</p><h1 id="文件分割">文件分割</h1><p><code>split</code> 命令可以用来分割文件：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">split -l <span style="color:#ae81ff">50000</span>  4-2019-09-02-15-54-17.log -d -a <span style="color:#ae81ff">2</span>  sp/4-2019-09-02-15-54-17_
</code></pre></div><p>参数说明：</p><ul><li><code>l</code>: 每个文件拆分的行数</li><li><code>d</code>: 拆分之后的文件用数字计数，没有该参数的话，用字母</li><li><code>a</code>： 拆分后生成顺序文件名的长度</li></ul><h1 id="压缩">压缩</h1><ol><li><p>zip</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">zip <span style="color:#f92672">[</span>-AcdDfFghjJKlLmoqrSTuvVwXyz$<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-b &lt;工作目录&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-ll<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-n &lt;字尾字符串&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-t &lt;日期时间&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-&lt;压缩效率&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>压缩文件名<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>待压缩文件...<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-i &lt;范本样式&gt;<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-x &lt;范本样式&gt;<span style="color:#f92672">]</span>
-A: 调整可执行的自动解压缩文件。
-b: &lt;工作目录&gt; 指定暂时存放文件的目录。
-c: 替每个被压缩的文件加上注释。
**-d: 从压缩文件内删除指定的文件**
-D: 压缩文件内不建立目录名称。
-F: 尝试修复已损坏的压缩文件。
-g: 将文件压缩后附加在既有的压缩文件之后，而非另行建立新的压缩文件.
**-i &lt;范本样式&gt;: 只压缩符合条件的文件。**
**-x &lt;范本样式&gt;: 压缩时排除符合条件的文件。**
-X: 不保存额外的文件属性。
-j: 只保存文件名称及其内容，而不存放任何目录名称。
-J: 删除压缩文件前面不必要的数据。
-l: 压缩文件时，把LF字符置换成LF+CR字符。
-ll: 压缩文件时，把LF+CR字符置换成LF字符。
**-m: 将文件压缩并加入压缩文件后，删除原始文件，即把文件移到压缩文件中**
**-n&lt;字尾字符串&gt;: 不压缩具有特定字尾字符串的文件。**
-q: 不显示指令执行过程
**-r: 递归处理，将指定目录下的所有文件和子目录一并处理。**
-t&lt;日期时间&gt;: 把压缩文件的日期设成指定的日期
-y: 直接保存符号连接，而非该连接所指向的文件，本参数仅在UNIX之类的系统下有效。
<span style="color:#75715e"># 示例</span>
zip -r search.zip search/  <span style="color:#75715e"># 将search目录打包的zip文件中</span>
zip -r -x *.css search.zip search/ <span style="color:#75715e"># 打包search目录，单不包含css文件</span>
</code></pre></div></li><li><p>使用zipsplit分割压缩的zip文件</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">zipsplit <span style="color:#f92672">(</span>选项<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>参数<span style="color:#f92672">)</span>
-n: 指定分割后每个zip文件的大小，是字节大小；
-t: 报告将要产生的较小的zip文件的大小；
-b: 指定分割后的zip文件的存放位置。
</code></pre></div></li><li><p>tar压缩 tar参数中 -x,-c,-t不能同时出现。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 打包</span>
tar <span style="color:#f92672">[</span>-j|-z<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>cv<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-f 新建的文件名<span style="color:#f92672">]</span> filename/dirname
<span style="color:#75715e"># 查看文件名</span>
tar <span style="color:#f92672">[</span>-j|-z<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>tv<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-f 新建的文件名<span style="color:#f92672">]</span>
<span style="color:#75715e"># 解压</span>
tar <span style="color:#f92672">[</span>-j|-z<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>xv<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-f 新建的文件名<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-C 目录<span style="color:#f92672">]</span>
-c: 新建打包文件
-t: 查看打包文件的内容有哪些文件名
-x: 解压功能，可以配合 C 解压到特定目录
-j: 通过bzip2来压缩/解压文件，此时文件名最好是 *.tar.bz2
-z: 通过gzip来压缩/解压文件，此时文件名最好是 *.tar.gz
-v: 在压缩/解压的过程中，将处理的文件名显示出来
-f filename: -f后接要处理的文件名
-C: 解压缩时，将文件解压到特定的目录

-p: 保留备份数据的原本权限与属性，常用于备份重要的配置文件
-P: 保留绝对路径
--exclude<span style="color:#f92672">=</span>FILE: 在压缩过程中，不打包FILE

<span style="color:#75715e"># 示例</span>
tar -zcv -f filename.tar.gz 要压缩的文件或目录名 <span style="color:#75715e">#压缩</span>
tar  -zxv -f filename.tar.gz -C 欲解压的目录  <span style="color:#75715e"># 解压</span>
tar -jcv -f system.tar.bz2 --exclude<span style="color:#f92672">=</span>/etc* --exclude<span style="color:#f92672">=</span>gz* /etc/root
</code></pre></div></li></ol><h1 id="访问网络内容-wget-curl">访问网络内容 <code>wget</code> <code>curl</code></h1><p><code>wget</code> 用于从网络上下载资源，若没有指定目录，默认为当前目录</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget <span style="color:#f92672">[</span>参数<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>url地址<span style="color:#f92672">]</span>
    -o, –output-file<span style="color:#f92672">=</span>FILE: 把**记录**写到FILE文件中
    -a, –append-output<span style="color:#f92672">=</span>FILE: 把**记录**追加到FILE文件中
    -d, –debug: 打印调试输出
    -q, –quiet: 安静模式<span style="color:#f92672">(</span>没有输出<span style="color:#f92672">)</span>
    -v, –verbose: 冗长模式<span style="color:#f92672">(</span>这是缺省设置<span style="color:#f92672">)</span>
    -nv, –non-verbose: 关掉冗长模式，但不是安静模式
    -i, –input-file<span style="color:#f92672">=</span>FILE: 下载在FILE文件中出现的URLs
    -F, –force-html: 把输入文件当作HTML格式文件对待
    -B, –base<span style="color:#f92672">=</span>URL: 将URL作为在-F -i参数指定的文件中出现的相对链接的前缀
    –sslcertfile<span style="color:#f92672">=</span>FILE: 可选客户端证书
    –sslcertkey<span style="color:#f92672">=</span>KEYFILE: 可选客户端证书的KEYFILE
    –egd-file<span style="color:#f92672">=</span>FILE: 指定EGD socket的文件名
    -t, –tries<span style="color:#f92672">=</span>NUMBER 设定最大尝试链接次数<span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> 表示无限制<span style="color:#f92672">)</span>.

    -O –output-document<span style="color:#f92672">=</span>FILE 把文档写到FILE文件中
    -nc, –no-clobber 不要覆盖存在的文件或使用.#前缀
    -c, –continue 接着下载没下载完的文件
    –progress<span style="color:#f92672">=</span>TYPE 设定进程条标记
    -N, –timestamping 不要重新下载文件除非比本地文件新
    -S, –server-response 打印服务器的回应
    –spider 不下载任何东西
    -T, –timeout<span style="color:#f92672">=</span>SECONDS 设定响应超时的秒数
    -w, –wait<span style="color:#f92672">=</span>SECONDS 两次尝试之间间隔SECONDS秒
    –waitretry<span style="color:#f92672">=</span>SECONDS 在重新链接之间等待1…SECONDS秒
    –random-wait 在下载之间等待0…2*WAIT秒
    -Y, –proxy<span style="color:#f92672">=</span>on/off 打开或关闭代理
    -Q, –quota<span style="color:#f92672">=</span>NUMBER 设置下载的容量限制
    –limit-rate<span style="color:#f92672">=</span>RATE 限定下载输率

    --post-data<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> : 通过post方式提交数据
</code></pre></div><h1 id="管道命令----cut-grep-sort-uniq">管道命令 <code>|</code> - <code>cut</code> <code>grep</code> <code>sort</code> <code>uniq</code></h1><p>每个<code>|</code>后面接的第一个数据必须是能够接受standard input数据的命令，而且管道命令只能处理standard output，对于error output会忽略</p><ol><li><p><code>cut</code> 命令</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cut –d <span style="color:#e6db74">&#39;分隔符&#39;</span> –f fields
    -d : 后边接分隔符， 与-f一起使用
    -f : 依据-d的分隔符将一段信息切割成为数段，有-f取出第几段的意思
last | cut –d <span style="color:#e6db74">&#39; &#39;</span> –f 1,2
</code></pre></div></li><li><p><code>grep</code> 可用正则</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">grep <span style="color:#f92672">[</span>-cinvP<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--color<span style="color:#f92672">=</span>auto<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;查找字符串(正则)&#39;</span> filename
    -c : 计算找到字符串的次数
    -i : 忽略大小写
    -n : 给出行号
    -v : 反向选择
    -P : 用Perl正则表达式来匹配
grep -–color<span style="color:#f92672">=</span>auto <span style="color:#e6db74">&#39;manpath&#39;</span> /etc/man.config
</code></pre></div></li><li><p><code>sort</code> 排序命令</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sort <span style="color:#f92672">[</span>-fbMnrtuk<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>file or stdin<span style="color:#f92672">]</span>
    -f: 忽略大小写
    -b: 忽略最前面的空格
    -M: 以月份的名字排序
    -n: 使用“纯数字”进行排序（默认是文字类型）
    -r: 反向排序
    -u: 同umiq
    -t: 分隔符，默认是<span style="color:#f92672">[</span>tab<span style="color:#f92672">]</span>分割
    -k: 以哪个区间来进行排序
</code></pre></div></li><li><p><code>uniq</code> 计数</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">uniq <span style="color:#f92672">[</span>-ic<span style="color:#f92672">]</span>
    -i: 忽略大小写字符的不同 
    -c: 进行计数
</code></pre></div></li></ol><h1 id="时间">时间</h1><p><code>date</code>命令能够通过<code>date +Format</code>设置输出格式</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">date +Format
    - %Y : 年份
    - %y : 年份的最后两位
    - %d : 按月计的日期<span style="color:#f92672">(</span>例如：01<span style="color:#f92672">)</span>
    - %D : 按月计的日期；等于%m/%d/%y
    - %H : 小时<span style="color:#f92672">(</span>00-23<span style="color:#f92672">)</span>
    - %I : 小时<span style="color:#f92672">(</span>00-12<span style="color:#f92672">)</span>
    - %m : 月份
    - %M : 分钟
    - %S : 秒<span style="color:#f92672">(</span>00-60<span style="color:#f92672">)</span>
date +%Y%m%d%H%M%S   <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">20170617194225</span>
<span style="color:#75715e"># 输出时间 是一小时前的时间</span>
date -d<span style="color:#e6db74">&#39;-1 hour&#39;</span> +%F<span style="color:#e6db74">&#39; &#39;</span> %T  
</code></pre></div><p>通过 <code>date -s</code> 设置时间</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">date -s 06/17/2017
date -s 19:42:25
</code></pre></div><h1 id="磁盘与目录容量">磁盘与目录容量</h1><ol><li><p><code>df</code> : 列出文件系统的整体磁盘使用量</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">df <span style="color:#f92672">[</span>-ahikHTm<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>目录或文件名<span style="color:#f92672">]</span>
    -a : 列出所有文件系统，包括系统特有的/proc等文件系统
    -h : 以人们较易阅读的GB、MB、KB等格式显示
    -i : 不用硬盘容量，而以inode的数量来显示
    -k/m : 以MB/KB的容量显示文件系统
</code></pre></div></li><li><p><code>du</code> : 评估文件系统的磁盘使用量</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">du <span style="color:#f92672">[</span>-ahskm<span style="color:#f92672">]</span> 文件或目录名称
    -a : 列出所有的文件与目录的容量，因为默认仅统计目录下面的文件量，不能同 s 一起使用
    -h : 以较易阅读的格式显示
    -s : 列出总量，不列出每个个别的目录占用量
    -S : 尚不理解
    -k/m : 以MB/KB的容量显示文件系统

du -sh ./*  <span style="color:#75715e"># 可以查看当前目录下文件大小，对于磁盘满了，寻找大文件很有用</span>
如果找不到，那么可以使用 <span style="color:#e6db74">`</span>find . -type f -size +500M<span style="color:#e6db74">`</span> 命令全局查找大文件
</code></pre></div></li></ol><h1 id="lsof-list-open-files"><code>lsof</code> (list open files)</h1><p>在linux下，任何事物都以文件的形式存在，通过文件不仅可以访问常规数据，还可以访问网络连接和硬件。如TCP和UDP套接字等。系统在后台都为该应用程序分配了一个文件描述符，该文件描述符提供了大量关于这个应用程序本身的信息。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">lsof
    -a : 列出打开文件存在的进程
    -c&lt;进程名&gt;: 列出指定进程所打开的文件
    -g : 列出GID号进程详情
    -d&lt;文件号&gt; : 列出占用该文件号的进程
    +d&lt;目录&gt; : 列出目录下被打开的文件
    +D&lt;目录&gt; : 递归列出目录下被打开的文件
    -n&lt;目录&gt; : 列出使用NFS的文件
    -i&lt;条件&gt; : 列出符合条件的进程。（4、6、协议、:端口、 @ip ）
    -p&lt;进程号&gt; : 列出指定进程号所打开的文件
    -u : 列出UID号进程详情
    -h : 显示帮助信息
    -v : 显示版本信息
</code></pre></div><h1 id="远程同步命令">远程同步命令</h1><h2 id="rsync命令"><code>rsync</code>命令</h2><p><code>rsync</code>命令是用来远程同步数据的，可以通过LAN/WAN快速同步多台机器间的文件。<code>rsync</code>通过自己的算法来比较本地和远程文件的不同部分，而不是每次都整份传送，所以速度比<code>scp</code>快。 <code>:</code>表明是通过远程shell连接，而<code>::</code> 和 <code>rsync://</code> 用于连接到rsync守护进程，它需要 src 或 dest 以模块名称开头</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 拷贝本地文件</span>
rsync <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> src dest
<span style="color:#75715e"># 使用一个远程shell程序将本地机器的内容拷贝到远程机器</span>
rsync <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> src <span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>host:dest
<span style="color:#75715e"># 使用一个远程shell将远程机器拷贝到本地机器</span>
rsync <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>host:src dest
<span style="color:#75715e"># 从远程rsync服务器中拷贝文件到本地机器</span>
rsync <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>host::src dest
<span style="color:#75715e"># 从本地机器拷贝文件到远程rsync服务器中</span>
rsync <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> src <span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>host::dest
<span style="color:#75715e"># 列远程机器的文件列表，类似rsync传输，不过需要在命令中省略本地机器</span>
rsync <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> rsync://<span style="color:#f92672">[</span>user@<span style="color:#f92672">]</span>host<span style="color:#f92672">[</span>:port<span style="color:#f92672">]</span>/src <span style="color:#f92672">[</span>dest<span style="color:#f92672">]</span>

<span style="color:#75715e"># 参数</span>
-v, --verbose: 详细模式输出
-q, --quiet: 精简模式输出
-c, --checksum: 打开校验开关
-a, --archive: 归档模式，表示以递归方式传输文件，并保持所有文件属性，相当于 <span style="color:#e6db74">`</span>-rlptgoD<span style="color:#e6db74">`</span>
-r, --recursive: 对子目录以递归模式处理
-R, --relative: 使用相对路径信息
-b, --backup: 创建备份
    --backup-dir<span style="color:#f92672">=</span>DIR 将备份文件放到 DIR 中
    --suffix<span style="color:#f92672">=</span>SUFFIX: 定义备份文件前缀
-u, --update: 跳过接收机器上较新的文件
-d, --dirs: 不会递归地传输目录
-l, --link: 保留软连接
-k, --copy-dirlinks: 将符号链接转换为指定目录
-K, --keep-dirlinks: 将符号链接作为一个递归的目录
-H, --hard-links: 保留硬链接
-p, --perms: 保持文件权限
-o, --owner: 保持文件属主信息
-g, --group: 保持文件属组信息。 
-D, --devices: 保持设备文件信息
** -t, --times: 保持文件时间信息  **
-S, --sparse: 对稀疏文件进行特殊处理以节省DST的空间
-w, --whole-file: 拷贝文件，不进行增量检测 
-x, --one-file-system: 不要跨越文件系统边界
-B, --block-size<span style="color:#f92672">=</span>SIZE: 检验算法使用的块尺寸，默认是700字节
-e, --rsh<span style="color:#f92672">=</span>command: 指定使用rsh、ssh方式进行数据同步
    --rsync-path<span style="color:#f92672">=</span>PATH: 指定远程服务器上的rsync命令所在路径信息
    --existing: 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件
    --delete: 删除那些DST中SRC没有的文件
    --delete-excluded: 同样删除接收端那些被该选项指定排除的文件
    --delete-after: 传输结束以后再删除
    --ignore-errors: 即使出现IO错误也进行删除
    --max-delete<span style="color:#f92672">=</span>NUM: 最多删除NUM个文件
-C, --cvs-exclude: 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件
-P, --partial: 保留那些因故没有完全传输的文件，以是加快随后的再次传输
--force: 强制删除目录，即使不为空
--numeric-ids: 不将数字的用户和组id匹配为用户名和组名
--timeout<span style="color:#f92672">=</span>time: ip超时时间，单位为秒
-I, --ignore-times: 不跳过那些有同样的时间和长度的文件
--size-only: 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间
--modify-window<span style="color:#f92672">=</span>NUM: 决定文件是否时间相同时使用的时间戳窗口，默认为0
-T --temp-dir<span style="color:#f92672">=</span>DIR: 在DIR中创建临时文件
--compare-dest<span style="color:#f92672">=</span>DIR: 同样比较DIR中的文件来决定是否需要备份。
--progress: 显示备份过程
-z, --compress: 对备份的文件在传输时进行压缩处理
    --exclude<span style="color:#f92672">=</span>PATTERN: 指定排除不需要传输的文件模式
    --include<span style="color:#f92672">=</span>PATTERN: 指定不排除而需要传输的文件模式
    --exclude-from<span style="color:#f92672">=</span>FILE: 排除FILE中指定模式的文件
    --include-from<span style="color:#f92672">=</span>FILE: 不排除FILE指定模式匹配的文件
    --version: 打印版本信息
    --address: 绑定到特定的地址
    --config<span style="color:#f92672">=</span>FILE: 指定其他的配置文件，不使用默认的rsyncd.conf文件
    --port<span style="color:#f92672">=</span>PORT: 指定其他的rsync服务端口
    --blocking-io: 对远程shell使用阻塞IO
    -stats: 给出某些文件的传输状态
    --progress: 在传输时现实传输过程
    --password-file<span style="color:#f92672">=</span>FILE: 从FILE中得到密码
-i, --itemize-changes: 输出所有更新的更改摘要
     --out-format<span style="color:#f92672">=</span>FORMAT     使用指定的FORMAT输出
     --log-file<span style="color:#f92672">=</span>FILE         将rsync做的操作记录到FILE中
     --list-only             只列出文件，而不拷贝
     --bwlimit<span style="color:#f92672">=</span>KBPS          限制I/O带宽，KBytes per second
-h, --help: 显示帮助信息。
</code></pre></div><p>示例：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rsync -azi machine::user/path/dir/ /search/odin/ --exclude <span style="color:#e6db74">&#39;*_log*&#39;</span>
</code></pre></div><h1 id="定时任务">定时任务</h1><p>在linux上，使用 <code>crontab</code> 来创建循环性工作调度。当然为了安全，可以通过<code>/etc/cron.allow</code>和<code>/etc/cron.deny</code>来限制用户使用 <code>crontab</code>。 当用户是用<code>crontab</code>来新建工作调度时，该项工作就会被记录到 <code>/var/spool/cron</code> 中，而且是以用户的账户来作为判别的。一般来说，不建议直接编辑<code>/var/spool/cron</code>中的文件，因为可能会由于输入语法错误，而导致 cron 不能正确执行。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">crontab <span style="color:#f92672">[</span>-u username<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-l|-e|-r<span style="color:#f92672">]</span>
-u: 只有root才能使用这个参数，可以用其他用户的名义新建/删除 crontab 任务 
-l: 查看 crontab 的内容
-e: 编辑 crontab 的内容
-r: 删除所有的 crontab 的工作内容

<span style="color:#75715e"># 示例</span>
<span style="color:#75715e"># 使用 crontab -e 进入到任务编辑页面</span>
crontab -e  
 <span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">1</span>  *  *  * shell exec.sh
<span style="color:#75715e">#分 时 日 月 周   执行内容</span>
</code></pre></div><p>只要通过 <code>:wq</code> 或者 <code>:x</code>，保存退出后，任务就自动定时执行。 配置时间方式如下表所示</p><table><thead><tr><th align="left">分</th><th align="left">时</th><th align="left">日期</th><th align="left">月</th><th align="left">周</th><th align="left">命令</th></tr></thead><tbody><tr><td align="left">0-59</td><td align="left">0-23</td><td align="left">1-31</td><td align="left">1-12</td><td align="left">0-7</td><td align="left">command</td></tr></tbody></table><p>“周”的0和7都是代表星期日的意思。还有一些辅助字符，如下：</p><table><thead><tr><th align="left">特殊字符</th><th align="left">代表意义</th></tr></thead><tbody><tr><td align="left">* (星号)</td><td align="left">代表任何时刻都接受，上例中，表示无论日月周是什么，知道是1点钟，就执行命令</td></tr><tr><td align="left">, (逗号)</td><td align="left">代表分隔时段的意思。如要执行任务的时间是 3:00 和 6:00, 那么配置是： <code>0 3,6 * * * command</code></td></tr><tr><td align="left">- (减号)</td><td align="left">代表一段时间范围内。8点到12点的每小时的20分钟执行任务，那么配置是： <code>20 8-12 * * * command</code></td></tr><tr><td align="left">/n</td><td align="left">n是数字，即每隔 n 单位的时间间隔执行命令。例如每五分钟执行一次： <code>*/5 * * * * command</code></td></tr></tbody></table><p><code>contab -e</code> 是针对用户的 cron 来设计的，如果是系统例行性任务，可以直接编辑 <code>/etc/crontab</code> 这个文件。 <code>/etc/crontab</code> 是一个纯文本文件，可以用root账号编辑。 cron 服务最低的检测限制是“分钟”，所以cron 会每分钟去读取一次 <code>/etc/crontab</code> 与 <code>/var/spool/cron</code> 中的数据，所以，只要编辑并保存这些文件，就会生效。如果不生效，可以使用 <code>/etc/init.d/crondrestart</code> 来重启 cron 服务。</p><h1 id="bash环境中的特殊符号">bash环境中的特殊符号</h1><p>bash环境中，有些符号是有特殊意义的：</p><table><thead><tr><th align="left">符号</th><th align="left">意义</th></tr></thead><tbody><tr><td align="left">#</td><td align="left">注释符号，最常用于script中</td></tr><tr><td align="left">\</td><td align="left">转义符号，之后跟的特殊符号作为一般符号处理</td></tr><tr><td align="left">|</td><td align="left">管道，分割两个管道命令</td></tr><tr><td align="left">;</td><td align="left">连续命令执行分隔符</td></tr><tr><td align="left">~</td><td align="left">用户的主文件夹</td></tr><tr><td align="left">$</td><td align="left">使用变量前导符号</td></tr><tr><td align="left">&amp;</td><td align="left">将命令在后台运行</td></tr><tr><td align="left">/</td><td align="left">目录符号</td></tr><tr><td align="left">\ &gt;, &raquo;</td><td align="left">数据流重定向，输出导向</td></tr><tr><td align="left">&lt;, &laquo;</td><td align="left">数据流重定向， 输入导向</td></tr><tr><td align="left">'&rsquo;</td><td align="left">单引号，不具有变量置换的功能</td></tr><tr><td align="left">&quot;&rdquo;</td><td align="left">双引号，具有变量置换的功能，其中的变量会用其值替换</td></tr><tr><td align="left">``</td><td align="left">两个 ` 中间为可以先执行的命令，也可以使用 $()</td></tr><tr><td align="left">()</td><td align="left">中间为子shell的起始与结束</td></tr><tr><td align="left">{ }</td><td align="left">中间为命令块的组合</td></tr></tbody></table><h1 id="进程查看">进程查看</h1><p>我们使用 <code>ps</code> <code>top</code> 和 <code>pstree</code> 来查看进程的运行情况。</p><h2 id="ps--将某个时间点的进程运行情况选取下来"><code>ps</code> : 将某个时间点的进程运行情况选取下来</h2><p>一般 <code>ps</code> 有两种用法： <code>ps -l</code> 仅查看自己的bash相关的进程； <code>ps aux</code> 查看所有系统运行的程序。语法如下：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ps <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span>
 -A: 所有的进程均显示出来
 -a: 与 terminal 无关的所有进程
 -u: 有效用户相关的进程
 x: 通常与 a 一起使用，可得到较为完整的信息

 l: 较详细地将PID的信息列出
 j: 工作的格式
 -f: 做一个更完整的输出

<span style="color:#75715e"># 示例</span>
ps aux
 USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         <span style="color:#ae81ff">1</span>  0.0  0.0  <span style="color:#ae81ff">10352</span>   <span style="color:#ae81ff">680</span> ?        Ss    <span style="color:#ae81ff">2015</span>  18:00 init <span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>                             
root         <span style="color:#ae81ff">2</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S&lt;    <span style="color:#ae81ff">2015</span>   1:40 <span style="color:#f92672">[</span>migration/0<span style="color:#f92672">]</span>
root         <span style="color:#ae81ff">3</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        SN    <span style="color:#ae81ff">2015</span>   0:50 <span style="color:#f92672">[</span>ksoftirqd/0<span style="color:#f92672">]</span>
root         <span style="color:#ae81ff">4</span>  0.0  0.0      <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span> ?        S&lt;    <span style="color:#ae81ff">2015</span>   0:00 <span style="color:#f92672">[</span>watchdog/0<span style="color:#f92672">]</span>
</code></pre></div><p><code>ps aux</code> 结果中，各字段的意义为：</p><table><thead><tr><th align="left">字段名</th><th align="left">字段含义</th></tr></thead><tbody><tr><td align="left">USER</td><td align="left">该进程属于哪个用户账号</td></tr><tr><td align="left">PID</td><td align="left">该进程的标志符</td></tr><tr><td align="left">%CPU</td><td align="left">该进程使用的CPU资源的百分比</td></tr><tr><td align="left">%MEM</td><td align="left">该进程所占用的物理内存百分比</td></tr><tr><td align="left">VSZ</td><td align="left">该进程使用的虚拟内存量</td></tr><tr><td align="left">RSS</td><td align="left">该进程占用的固定内容量</td></tr><tr><td align="left">TTY</td><td align="left">该进程是在哪个终端机上运行，若与终端无关则显示 ?；若为 pts/0 表示由网络连接的主机进程</td></tr><tr><td align="left">STAT</td><td align="left">该进程目前的状态。R(正在运行), S(可唤醒的睡眠状态), D(不可唤醒的睡眠状态，通常为等待I/O), T(停止状态), Z(僵尸状态，进程已经终止但无法删除)</td></tr><tr><td align="left">START</td><td align="left">该进程启动的时间</td></tr><tr><td align="left">TIME</td><td align="left">该进程使用CPU运行时间</td></tr><tr><td align="left">COMMAND</td><td align="left">该进程是哪个命令产生的</td></tr></tbody></table><h2 id="top-动态查看进程的变化">top 动态查看进程的变化</h2><p><code>top</code> 命令可以持续检测程序的运行状态，使用方式如下：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">top <span style="color:#f92672">[</span>-d 数字<span style="color:#f92672">]</span> | top <span style="color:#f92672">[</span>-bnp<span style="color:#f92672">]</span>
参数如下：
-d: 后面可以接秒数，就是整个进程界面更新的秒数，默认是 5s
-b: 以批次的方式执行top，通常会结合数据流重定向来批处理结果
-n: 与 -b 搭配，表示需要进行几次 top 结果的数据
-p: 指定某些PID来进行查看
-H: 显示线程
在top命令中，可以使用如下按键命令：
   ?: 显示在top当中可以输入的按键指令
   P: 以 CPU 的使用资源排序显示
   M: 以内存的使用资源排序显示
   N: 以PID来排序
   T: 该进程使用的CPU时间累积排序
   k: 给予某个PID一个信号
   r: 给某个PID重新定制一个nice属性
   q: 离开top
</code></pre></div><h2 id="pstree-查看进程树">pstree 查看进程树</h2><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pstree <span style="color:#f92672">[</span>-A|U<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-up<span style="color:#f92672">]</span>
参数：
-A: 各进程树之间的连接
-U: 各进程树之间的连接以utf8码的字符来连接
-p: 列出每个进程的PID
-u: 列出每个进程的账号
示例：

init<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>-+-agetty<span style="color:#f92672">(</span>2112<span style="color:#f92672">)</span>
        |-crond<span style="color:#f92672">(</span>2071<span style="color:#f92672">)</span>---crond<span style="color:#f92672">(</span>13076<span style="color:#f92672">)</span>---sh<span style="color:#f92672">(</span>13084<span style="color:#f92672">)</span>---sleep<span style="color:#f92672">(</span>13112<span style="color:#f92672">)</span>
        |-events/0<span style="color:#f92672">(</span>8<span style="color:#f92672">)</span>
        |-events/1<span style="color:#f92672">(</span>9<span style="color:#f92672">)</span>
        |-glusterfs<span style="color:#f92672">(</span>19972<span style="color:#f92672">)</span>-+-<span style="color:#f92672">{</span>glusterfs<span style="color:#f92672">}(</span>19973<span style="color:#f92672">)</span>
        |                  <span style="color:#ae81ff">\`</span>-<span style="color:#f92672">{</span>glusterfs<span style="color:#f92672">}(</span>19982<span style="color:#f92672">)</span>
        |-httpd<span style="color:#f92672">(</span>1988<span style="color:#f92672">)</span>-+-httpd<span style="color:#f92672">(</span>884,apache<span style="color:#f92672">)</span>
</code></pre></div><h2 id="kill-进程管理">kill 进程管理</h2><p>我们可以使用 kill 或者 killall 来向进程发送信号。使用如下：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kill -signal PID
killall <span style="color:#f92672">[</span>-iIe<span style="color:#f92672">]</span> -signal 命令名称
参数: 
-i: interactive ，交互式的，若需要删除，会出现提示
-e: exact，表示后边接的 命令名称 要一致，但完整的命令不能超过15个字符
-I: 命令名称（可能含有参数），忽略大小写
</code></pre></div><p>其中常用的 signal 有：</p><table><thead><tr><th align="left">代号</th><th align="left">名称</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">SIGHUP</td><td align="left">启动被终止的进程，可以让该PID重新读取自己的配置，类似重启</td></tr><tr><td align="left">2</td><td align="left">SIGINT</td><td align="left">相当于使用键盘的 ctrl+c 来中断一个进程</td></tr><tr><td align="left">9</td><td align="left">SIGKILL</td><td align="left">代表强行中断一个进程的运行，如果进程执行到一半，尚未完成的部分不会被处理</td></tr><tr><td align="left">15</td><td align="left">SIGTERM</td><td align="left">正常结束进程的执行。后续操作完成后，才终止</td></tr><tr><td align="left">17</td><td align="left">SIGSTOP</td><td align="left">相当于使用键盘的 ctrl+z 来暂停一个进程的执行</td></tr></tbody></table><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 关闭特定的进程</span>
kill -SIGHUP <span style="color:#66d9ef">$(</span>ps aux | grep <span style="color:#e6db74">&#39;syslog&#39;</span> | grep -v <span style="color:#e6db74">&#39;grep&#39;</span> | awk <span style="color:#e6db74">&#39;{print $2}&#39;</span><span style="color:#66d9ef">)</span>

<span style="color:#75715e"># 关闭一个命令开启的所有进程</span>
killall -i -9 bash
</code></pre></div><h1 id="文件格式化处理----grep-sed-awk">文件格式化处理 &ndash; <code>grep</code>, <code>sed</code>, <code>awk</code></h1><h2 id="sed"><code>sed</code></h2><p><code>sed</code> 是一个管道命令，有将数据进行替换、删除、新增、选取特定行等功能。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sed <span style="color:#f92672">[</span>-nerf<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>动作<span style="color:#f92672">]</span>
-n: 安静模式，只有经过处理的那行才会被列出来
-e: 直接在命令行模式上进行 sed 的动作编辑
-f: 直接将sed的动作写在一个文件中
-r: sed支持扩展型正则表达式
-i: 直接修改读取文件的内容

动作说明
    n1, n2: 可选内容，代表选择进行动作的行数；若动作需要在 10到20行之间进行，则 10,20 <span style="color:#66d9ef">function</span>
    <span style="color:#66d9ef">function</span> 有如下参数：
        a: 新增
        c: 替换
        d: 删除
        i: 插入
        p: 打印
        s: 替换，通常s搭配正则表达式
</code></pre></div><p>假设 <code>/etc/passwd</code> 中有如下内容：</p><pre><code>root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
</code></pre><p>删除用法如下：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># 删除2~3行</span>
nl /etc/passwd | sed <span style="color:#e6db74">&#39;2,3d&#39;</span>
<span style="color:#75715e"># 控制台输出</span>
     1	root:x:0:0:root:/root:/bin/bash
     4	adm:x:3:4:adm:/var/adm:/sbin/nologin
     5	lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
     6	sync:x:5:0:sync:/sbin:/bin/sync
</code></pre></div><p>添加用法如下：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># 在第二行后加上 drink tea ...... 与 drink beer?</span>
nl /etc/passwd | sed <span style="color:#e6db74">&#39;2a drink tea ...... \
</span><span style="color:#e6db74">&gt; drink beer?&#39;</span>
<span style="color:#75715e">## 控制台输出</span>
     1	root:x:0:0:root:/root:/bin/bash
     2	bin:x:1:1:bin:/bin:/sbin/nologin
drink tea ...... 
drink beer?
     3	daemon:x:2:2:daemon:/sbin:/sbin/nologin
     4	adm:x:3:4:adm:/var/adm:/sbin/nologin
     5	lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
     6	sync:x:5:0:sync:/sbin:/bin/sync
</code></pre></div><p>输出指定行（使用 <code>-n</code> 安静模式）</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># 输出第2到4行</span>
nl /etc/passwd | sed -n <span style="color:#e6db74">&#39;2,4p&#39;</span>
<span style="color:#75715e"># 控制台输出如下</span>
     2	bin:x:1:1:bin:/bin:/sbin/nologin
     3	daemon:x:2:2:daemon:/sbin:/sbin/nologin
     4	adm:x:3:4:adm:/var/adm:/sbin/nologin
</code></pre></div><p>整行替换：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># 替换第 2到3行</span>
nl /etc/passwd | sed <span style="color:#e6db74">&#39;2,3c No 2-3number&#39;</span>
<span style="color:#75715e"># 控制台输出如下</span>
     1	root:x:0:0:root:/root:/bin/bash
No 2-3number
     4	adm:x:3:4:adm:/var/adm:/sbin/nologin
     5	lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
     6	sync:x:5:0:sync:/sbin:/bin/sync
</code></pre></div><p>部分数据查找替换：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sed <span style="color:#e6db74">&#39;s/要被替换的字符串/新字符串/g&#39;</span>
/sbin/ifconfig eth0 | grep <span style="color:#e6db74">&#34;inet addr&#34;</span> |sed <span style="color:#e6db74">&#39;s/^.*addr://g&#39;</span> | sed <span style="color:#e6db74">&#39;s/Bcast.*$//g&#39;</span>
<span style="color:#75715e"># 控制台输出</span>
192.168.0.1

<span style="color:#75715e"># 还可以使用正则匹配捕获内容，替换中 \0 代表整行，\1 代表捕获的第一个内容</span>
sed -rn <span style="color:#e6db74">&#39;s/.*filter_([0-9]+).*$/\0@@@\1/p&#39;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ob.resin.201803281530
cat adcost | awk <span style="color:#e6db74">&#39;{sum+=$1} END {print &#34;Avg= &#34;, sum/NR}&#39;</span>

awk <span style="color:#e6db74">&#39;BEGIN {max = 0} {if ($1+0 &gt; max+0) max=$1} END {print &#34;Max=&#34;, max}&#39;</span> adcost
sed -rn <span style="color:#e6db74">&#39;s/.*NewBlacklistFilter_([0-9]+).*$/\0@@@\1/p&#39;</span>  | awk <span style="color:#e6db74">&#39;BEGIN {FS=&#34;@@@&#34;}  {if $2 &gt;0 sum+=$2} END {print &#34;AVG= &#34;, sum/NR}&#39;</span> 
| awk <span style="color:#e6db74">&#39;{sum+=$1} END {print &#34;Avg= &#34;, sum/NR}&#39;</span>

grep -P <span style="color:#e6db74">&#39;cost:[0-9]+&#39;</span> --color
</code></pre></div><h2 id="grep-命令"><code>grep</code> 命令</h2><h2 id="awk-命令"><code>awk</code> 命令</h2><p><code>awk</code> 内建了如下变量：</p><table><thead><tr><th align="left">变量符号</th><th align="left">变量说明</th></tr></thead><tbody><tr><td align="left"><code>$0</code></td><td align="left">当前行的内容</td></tr><tr><td align="left"><code>$1~$n</code></td><td align="left">当前行的第n个字段，字段间由 <code>FS</code> 分隔</td></tr><tr><td align="left"><code>FS</code></td><td align="left">字段分隔符，默认是空格或者Tab</td></tr><tr><td align="left"><code>NF</code></td><td align="left">当前记录中字段个数，即列数</td></tr><tr><td align="left"><code>NR</code></td><td align="left">行号，从1开始，有多个文件，该值也会累加</td></tr><tr><td align="left"><code>FNR</code></td><td align="left">当前记录数，文件自己的行号</td></tr><tr><td align="left"><code>RS</code></td><td align="left">行的分隔符，默认是换行</td></tr><tr><td align="left"><code>OFS</code></td><td align="left">输出字段分隔符，默认是空格</td></tr><tr><td align="left"><code>ORS</code></td><td align="left">输出行的分隔符，默认是换行符</td></tr><tr><td align="left"><code>FILENAME</code></td><td align="left">当前文件名</td></tr></tbody></table><h3 id="awk-条件判断"><code>awk</code> 条件判断</h3><p><code>awk</code> 做条件判断，可以用如下方式：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cat /etc/passwd | awk <span style="color:#e6db74">&#39;{FS=&#34;&#34;:} $3 &lt; 10 {print $1 &#34;\t&#34; $3}&#39;</span>
<span style="color:#75715e"># 使用 if</span>
cat /etc/passwd | awk <span style="color:#e6db74">&#39;{FS=&#34;&#34;:} {if($3&lt;10) printf &#34;%10s\t%10s&#34;, $1, $3}&#39;</span> 
</code></pre></div><h3 id="awk-正则匹配"><code>awk</code> 正则匹配</h3><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">awk <span style="color:#e6db74">&#39;/nologin/&#39;</span> /etc/passwd
<span style="color:#75715e">## 控制台输出</span>
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
</code></pre></div><p>匹配某个字段中出现的字符：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">awk -F <span style="color:#e6db74">&#39;:&#39;</span> <span style="color:#e6db74">&#39;$1 ~ /oo/&#39;</span> /etc/passwd
<span style="color:#75715e"># 控制台输出</span>
root:x:0:0:root:/root:/bin/bash
</code></pre></div><p>正则匹配某个字段中出现的字符</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">awk -F <span style="color:#e6db74">&#39;:&#39;</span> <span style="color:#e6db74">&#39;$1 ~ /o+/&#39;</span> /etc/passwd
<span style="color:#75715e"># 控制台输出</span>
root:x:0:0:root:/root:/bin/bash
daemon:x:2:2:daemon:/sbin:/sbin/nologin
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</code></pre></div><h3 id="awk-内建函数"><code>awk</code> 内建函数</h3><table><thead><tr><th align="left">函数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><code>atan2(y,x)</code></td><td align="left">y/x 的反正切值</td></tr><tr><td align="left"><code>cos(x)</code></td><td align="left">x 的余弦值</td></tr><tr><td align="left"><code>exp(x)</code></td><td align="left">x 的指数函数</td></tr><tr><td align="left"><code>int(x)</code></td><td align="left">x 的整数部分</td></tr><tr><td align="left"><code>log(x)</code></td><td align="left">x 的自然对数</td></tr><tr><td align="left"><code>rand()</code></td><td align="left">返回一个随机数</td></tr><tr><td align="left"><code>sin(x)</code></td><td align="left">x 的正弦值</td></tr><tr><td align="left"><code>sqrt(x)</code></td><td align="left">x 的平方根</td></tr><tr><td align="left"><code>srand(x)</code></td><td align="left">x 是 rand() 的随机数种子</td></tr></tbody></table><p>字符串函数：</p><table><thead><tr><th align="left">函数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><code>gsub(r,s)</code></td><td align="left">将字符串中所有出现的r替换为s,返回替换发生的次数</td></tr><tr><td align="left"><code>gsub(r,s,t)</code></td><td align="left">将字符串t中所有出现的r替换为s,返回替换发生的次数</td></tr><tr><td align="left"><code>index(s,t)</code></td><td align="left">返回字符串t在s中第一次出现的位置，如果t没有出现的话，返回0</td></tr><tr><td align="left"><code>length(s)</code></td><td align="left">返回s包含的字符个数</td></tr><tr><td align="left"><code>match(s,r)</code></td><td align="left">测试s是否包含能被r匹配的子串，返回子串的起始位置或0；设置RSTART和RLENGTH</td></tr><tr><td align="left"><code>split(s,a)</code></td><td align="left">用 FS 将 s 分隔到数组 a 中，返回字段个数</td></tr><tr><td align="left"><code>split(s,a,fs)</code></td><td align="left">用fs分割s到数组a中， 返回字段的个数</td></tr><tr><td align="left"><code>sprintf(fmt,expr-list)</code></td><td align="left">根据格式字符串fmt返回格式化后的expr-list</td></tr><tr><td align="left"><code>sub(r,s)</code></td><td align="left">将$0的最左最长的，能被r匹配的子字符串替换为s，返回替换发生的次数</td></tr><tr><td align="left"><code>sub(r,s,t)</code></td><td align="left">把t的最左最长的，能被r匹配的子字符串替换为s，返回替换发生的次数</td></tr><tr><td align="left"><code>substr(s,p)</code></td><td align="left">返回s中从位置p开始的后缀</td></tr><tr><td align="left"><code>substr(s,p,n)</code></td><td align="left">返回s中从位置p开始的，长度为n的子字符串</td></tr></tbody></table><h1 id="其他快捷方式">其他快捷方式</h1><ol><li>使用快捷键 <code>ctrl+r</code> 可以快速使用历史命令</li></ol></article></div><div class="card-action"><i class="material-icons">local_offer</i> <a class="tag" href="https://wzhongke.github.io//tags/linux">#linux</a>&nbsp;</div><div class="card-action"><div class="comments"><div id="disqus_thread"></div></div><script type="text/javascript">var disqus_shortname = 'wzhongke';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="pagination-single"><span class="pagination-item previous"><i class="material-icons">navigate_before</i> <a href="https://wzhongke.github.io/post/front/javascript-%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7/" rel="prev">javascript 常用技巧</a> </span><span class="pagination-item next"><i class="material-icons">navigate_next</i> <a href="https://wzhongke.github.io/post/markdown%E8%AF%AD%E6%B3%95/" rel="next">markdown 语法</a></span></div></div></section></div></section><footer class="page-footer"><div class="container"><div class="row"><div class="col l6 s12"><h5 class="white-text">World of Wang</h5><p class="grey-text text-lighten-4">Theme <a href="https://github.com/stkevintan/hugo-YAMT-theme" target="_blank">YAMT</a> designed by <a href="https://github.com/stkevintan" target="_blank">Kevin Tan</a> with ❤</p></div><div class="col l4 offset-l2 s12"><h5 class="white-text">My Friends</h5><ul><li><a class="grey-text text-lighten-3" href="https://frantic1048.logdown.com/" target="_blank">Frantic1048</a></li></ul></div></div></div><div class="footer-copyright"><div class="container">Copyright@Kevin Tan</div></div></footer></main><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script type="text/javascript" src="//dlweb.sogoucdn.com/common/lib/jquery/jquery-1.11.0.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/lunr.js/2.1.2/lunr.min.js"></script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']]
      }
    });</script><script type="text/javascript" src="https://wzhongke.github.io//js/materialize.min.js"></script><script type="text/javascript" src="https://wzhongke.github.io//js/index-1c463e212c.js"></script><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-9350854994277981",
        enable_page_level_ads: true
    });</script></body></html>